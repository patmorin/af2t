\documentclass{patmorin}
\listfiles
\usepackage{pat}
\usepackage{paralist}
\usepackage{dsfont}  % for \mathds{A}
\usepackage[utf8x]{inputenc}
\usepackage{skull}
\usepackage{paralist}
\usepackage{graphicx}
\usepackage[noend]{algorithmic}

\usepackage[normalem]{ulem}
\usepackage{cancel}
\usepackage{enumitem}

\usepackage{todonotes}

\usepackage[longnamesfirst,numbers,sort&compress]{natbib}

\usepackage[mathlines]{lineno}
\setlength{\linenumbersep}{2em}
% \linenumbers
% \rightlinenumbers
% \linenumbers
\newcommand*\patchAmsMathEnvironmentForLineno[1]{%
 \expandafter\let\csname old#1\expandafter\endcsname\csname #1\endcsname
 \expandafter\let\csname oldend#1\expandafter\endcsname\csname end#1\endcsname
 \renewenvironment{#1}%
    {\linenomath\csname old#1\endcsname}%
    {\csname oldend#1\endcsname\endlinenomath}}%
\newcommand*\patchBothAmsMathEnvironmentsForLineno[1]{%
 \patchAmsMathEnvironmentForLineno{#1}%
 \patchAmsMathEnvironmentForLineno{#1*}}%
\AtBeginDocument{%
\patchBothAmsMathEnvironmentsForLineno{equation}%
\patchBothAmsMathEnvironmentsForLineno{align}%
\patchBothAmsMathEnvironmentsForLineno{flalign}%
\patchBothAmsMathEnvironmentsForLineno{alignat}%
\patchBothAmsMathEnvironmentsForLineno{gather}%
\patchBothAmsMathEnvironmentsForLineno{multline}%
}


\newcommand{\coloured}[2]{{\color{#1}{#2}}}
\newenvironment{colourblock}[1]{\color{#1}}{}

\newcommand{\condref}[1]{(C\ref{#1})}

% Taken from
% https://tex.stackexchange.com/questions/42726/align-but-show-one-equation-number-at-the-end
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}


\setlength{\parskip}{1ex}


\DeclareMathOperator{\diam}{diam}
\DeclareMathOperator{\tw}{tw}
\DeclareMathOperator{\stw}{stw}
\DeclareMathOperator{\ltw}{ltw}
\DeclareMathOperator{\pw}{pw}
\DeclareMathOperator{\lpw}{lpw}
\DeclareMathOperator{\lhptw}{lhp-tw}
\DeclareMathOperator{\lhppw}{lhp-pw}

\DeclareMathOperator{\x}{x}
\DeclareMathOperator{\depth}{d}
\DeclareMathOperator{\sh}{cbt}
\DeclareMathOperator{\cbt}{cbt}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\dc}{dc}

\newcommand{\ellt}{{\lfloor\ell/2\rfloor}}

\title{\MakeUppercase{Pathwidth-$2$ Graphs have Unbounded Anagram-Free Chromatic Number}\thanks{This research was partly funded by NSERC.}}
\author{Saman Bazarghani%
    \thanks{Department of Computer Science and Electrical Engineering, University of Ottawa}\qquad
    Therese Biedl%
    \thanks{Department of Computer Science and Electrical Engineering, University of Ottawa}\qquad
    Vida DujmoviÄ‡\footnotemark[2]\qquad
    Pat Morin\footnotemark[3]%
    \thanks{School of Computer Science, Carleton University}}

\DeclareMathOperator{\ddiv}{div}
\DeclareMathOperator{\hist}{h}

\newcommand{\colored}[2]{{\color{#1}#2}}

\usepackage{tabularx}

\DeclareMathOperator{\ci}{\overline{\pi}}

\begin{document}

% \begin{titlepage}
\maketitle

\begin{abstract}
    We show that outerplanar graphs of pathwidth $2$ do do not have anagram-free edge or vertex colourings with a bounded number of colours.
\end{abstract}
% \end{titlepage}

% \pagenumbering{roman}
% \tableofcontents
%
% \newpage
% \pagenumbering{arabic}


\section{Introduction}

Let $s:=s_1,\ldots,s_n$ be a string over an alphabet $A$ and, for each $a\in A$, define $\hist_a(s):=|\{i\in\{1,\ldots,n\}:s_i=a\}$.  The \emph{histogram} of $s$ is the real-valued $|A|$-vector $\hist(s):=(\hist_a(s):a\in A)$ indexed by elements of $A$.  Let $\|\cdot\|_1$ denote the L1 norm.  Note that a string $s_1,\ldots,s_{2r}$ is an anagram if and only if $\hist(s_1,\ldots,s_r)=\hist(s_{r+1},\ldots,s_{2r})$.  Equivalently, $\hist(s_1,\ldots,s_r)-\hist(s_{r+1},\ldots,s_{2r})=\boldsymbol{0}$ or
$\|\hist(s_1,\ldots,s_r)-\hist(s_{r+1},\ldots,s_{2r})\|_1=0$.

A string $s\in A^*$ is $\ell$-periodic if each length-$\ell$ substring of $s$ contains every character in $A$.  We make use of the following lemma:

\begin{lem}\label{near_anagram_fourier}
    For each $C,r_0,\ell\in\N$ and each $\epsilon>0$, there exists a positive integer $N$ such that each anagram-free $\ell$-periodic string $s_1,\ldots,s_N\in\{1,\ldots,C\}^N$ contains a substring $s_{i+1},\ldots,s_{i+2r}$ of length $2r \ge 2r_0$ such that $\|\hist(s_{i+1},\ldots,s_{i+r})-\hist(s_{i+r+1},\ldots,s_{i+2r})\|_1 \le \epsilon r$.
\end{lem}

The proof of \cref{near_anagram_fourier} is deferred to \cref{near_anagram_section}.  We now give some intuition as to how it is used.  \cref{near_anagram_fourier} tells us that, even though we cannot always find an anagram, we can always find a substring that is $\epsilon$-close to being an anagram.  The process of checking if a string is anagram is often viewed as finding common terms in the first and second halves and crossing them both out.  If this results in a complete cancellation, then the string is an anagram.  \cref{near_anagram_fourier} tells us that we can always find a substring where, after exhaustive cancellation, only an $\epsilon$ fraction of the original terms remain.

Our strategy is to use \cref{near_anagram_fourier} to show that, if four terms in one half are allowed to gang up and cancel six terms in the second half (and vice-versa) then (under conditions that we guarantee) we will be able to fully complete the cancellation process.  To achieve this type of four versus six cancellation, we study a small subgraph that has a set of four paths that use every edge exactly twice and also has a set of three paths that use every edge exactly once.  Using the latter set of paths twice gives a collection of six paths that covers every edge twice.  Thus four terms in one half can be used to cancel six terms in the other half.


\section{Edge Colouring}

For any $n\in N$, let $S_n$ be the graph with vertex set $V(S_n):=\{a_1,\ldots,a_n,b_1,\ldots,b_n\}$ and edge set
\[
    E(S_n) := \bigcup_{i=1}^{n-1} \{a_ib_i,a_ia_{i+1},b_ib_{i+1},a_ib_{i+1}\} \cup \{a_nb_n\} \enspace
\]
(see \cref{s_n}).

\begin{figure}
    \begin{center}
        \includegraphics{figs/s_n}
    \end{center}
    \caption{The graph $S_n$}
    \label{s_n}
\end{figure}

Our first result shows that the anagram-free chromatic index of $S_n$ is unbounded.

\begin{thm}\label{edge_colouring}
    For any $c\in\N$, there exists $n\in\N$ such that, for any edge $c$-colouring $\varphi:E(S_n)\to\{1,\ldots,c\}$ of $S_n$, there exists a path $v_0,\ldots,v_{2r}$ in $S_n$ such that $\varphi(v_0v_1),\ldots,\varphi(v_{r-1}v_r)$ is a permutation of $\varphi(v_rv_{r+1},\ldots,v_{2r-1}v_{2r})$.
\end{thm}

Let $S_n':=S_n-\{a1b_1,a_nb_n\}$. Before proving \cref{edge_colouring} we need the following easy constructions that allow the kind of four versus six cancellation described earlier.  These three lemmas are illustrated in \cref{good_paths}:\todo{Write these paths down for the visually impaired.}

\begin{figure}
    \begin{center}
        \begin{tabularx}{\textwidth}{XXX}
        % \multicolumn{2}{c}{$P$} \\
        % \includegraphics{figs/pq-1} \newline
        % \includegraphics{figs/pq-2} \newline
        % \includegraphics{figs/pq-3} \newline
        % \includegraphics{figs/pq-4} &
        \includegraphics{figs/pq-8} \newline
        \includegraphics{figs/pq-9} \newline
        \includegraphics{figs/pq-10} \newline
        \includegraphics{figs/pq-11} &
        % \multicolumn{2}{c}{$Q$} \\
        % \includegraphics{figs/pq-5} \newline
        % \includegraphics{figs/pq-6} \newline
        % \includegraphics{figs/pq-7} &
        \includegraphics{figs/pq-12} \newline
        \includegraphics{figs/pq-13} \newline
        \includegraphics{figs/pq-14} &
        \includegraphics{figs/r-8} \newline
        \includegraphics{figs/r-9} \newline
        \includegraphics{figs/r-10}
        \end{tabularx}
    \end{center}
    \caption{The paths $P_1,\ldots,P_4$ and $Q_1,\ldots,Q_3$, and $R_1,\ldots,R_4$ in $S_n$.}
    \label{good_paths}
\end{figure}

\begin{lem}
    For each $n\ge 3$, the graph $S_n'$ contains four paths $P_1,\ldots,P_4$.  For each $(x,y)\in\{a_1,b_1\}\times\{a_n,b_n\}$ exactly one of these paths begins at $x$ and ends at $y$.  Each edge of $S_n'$ is used by exactly two of these paths.
\end{lem}

\begin{lem}
    For each $n\ge 3$, the graph $S_n'$ contains three paths $Q_1,\ldots,Q_3$ that each begin at a vertex in $\{a_1,b_1\}$ and at a vertex in $\{a_3,b_3\}$.  Each edge in $S_n'$ is used in exactly one of these paths.
\end{lem}


In addition to the path sets described above, we need a simple gadget with three paths $a_1\rightsquigarrow a_3$, $a_1\rightsquigarrow b_3$ and $b_1\rightsquigarrow a_1$ without interfering with larger adjacent pieces.


\begin{lem}
    The graph $S_3'$ contains three paths $R_1,\ldots,R_3$. For each $(x,y)\in\{(a_1,a_3),(a_1,b_3),(b_1,a_1)\}$ exactly one of these paths begins at $x$ and ends at $y$ and this path includes exactly one of $\{a_1,b_1\}$ and exactly one of $\{a_3,b_3\}$.
\end{lem}

Observe that, for $n=2t+1$, $S_n$ can be constructed by gluing together $t$ copies of $S_3$ where the vertices $a_3$ and $b_3$ in each copy are identified with the vertices $a_1$ and $b_1$ in the next copy.  In our proof we will not use the edges $a_{2x+1}b_{2x+1}$ for any $x\in\{0,\ldots,t\}$  (which is why these edges are lighter in \cref{s_n}).  Thus, the graph we are really interested in is the graph obtained by gluing together $t$ copies of $S_3'$.  We now proceed with the proof of \cref{edge_colouring}.

\begin{proof}[Proof of \cref{edge_colouring}]
  Consider the graph $S_N$ for a very large value $N:=2t+1$ to be discussed shortly.  As discussed above, this graph is obtained by from $t$ copies of $S_3$ and we will only make use of the edges in $S_3'$.  The graph $S_3'$ has $7$ edges and therefore has a set $X$ of $c^7$ possible edge $c$-colourings.
  For $X'\subseteq X$, we say that an edge colouring of $S_N$ is $X'$-restricted each of the $t$ copies of $S_3$ uses a colouring in $X'$.

  Suppose, for the sake of contradiction, that $S_N$ has anagram-free edge-colouring that uses $c$ colours, for every $N\in\N$.  Take a minimal subset $X'\subseteq X$ such that $S_N$ has an $X'$-restricted anagram-free $c$-edge colouring for every $N\in\N$.  This implies that there exists an integer $\ell:=\ell(X')$ such that, for every $N\in\N$, every $i\in\{0,\ldots,t-\ell\}$, every $X'$-restricted anagram-free edge $c$-colouring of $S_N$ and every $\rho\in X$, the subgraph of $S_N$ induced by $\{a_{2i+1},\ldots,a_{2(i+\ell)+1}\}\cup \{b_{2i+1},\ldots,b_{2(i+\ell)+1}\}\}$ contains a copy of $S_3'$ coloured using $\rho$.


  Fix some $X'$-restricted anagram-free edge $c$-colouring $\varphi$ of $S_N$.
  Now select any $\rho\in X'$ and use each occurrence of the colouring $\rho$ to break $S_N$ into blocks, each of length at most $\ell$ with each pair of consecutive blocks separated by a copy of $S_3'$ coloured using the colouring $\rho$.  Now, each block is a copy of $S_k$ for some $k\in\{3,\ldots,\ell-1\}$.  The graph $S_k'$ has $4k-5$ edges and therefore has at most $c^{4k-5}$ possible edge $c$-colourings.  Thus, there are at most $\sum_{k=3}^{\ell-1} c^{4k-5} < c^{4\ell-5}$ types of blocks.\todo{constants.}

  These blocks define a string $s_0,\ldots,s_m$ over an alphabet $A$ of size $C\le c^{4\ell-4}$.  Let $r_0:=10^{100}$ and $\epsilon=1/1000000c^{4\ell-4}\ell$. Note that $\epsilon$ and $r_0$ depends only on $\ell$, which depends only on $X'$, which depends only $c$.  None of these values depends on $N:=2t+1$.  Therefore, by \cref{near_anagram_fourier}, we can choose $t$ sufficiently large to obtain a substring $p:=p_1,\ldots,p_{2r}$ of $s_0,\ldots,s_m$ whose length is $2r>2r_0$ and such that $\|\hist(p_1,\ldots,p_{r})-\hist(p_{r+1},\ldots,p_{2r})\|_1\le \epsilon r$.

  The substring $p_1,\ldots,p_{2r}$ corresponds to a sequence of $2r$ blocks in the original graph $S_n$. For each $x\in X'$, let $\delta_x:=\hist_x(p_1,\ldots,p_r)-\hist_x(p_{r+1},\ldots,p_{2r})$.  By \cref{near_anagram_fourier}, $|\delta_x|\le \epsilon r$.

  To deal with the fact that $\delta_x>0$ we need $6\delta_x$ copies of $x$ in $p_1,\ldots,p_r$ and $4\delta_x$ copies of $x$ in $p_{r+1},\ldots,p_{2r}$.  By using paths $Q_1,\ldots,Q_3$ ($2\delta_x$ times each) in the first half and using $P_1,\ldots,P_r$ ($\delta_x$ times each) in the second half we are able to cancel everything.\todo{First deal with the parity issue. (First $S_3$ colourings, then $S_{\le\ell}$ colourings, then parity vectors.)}  This is not a problem because each of these contains at least $r/\ell$ copies of $x$.  Doing this for each $x\in X'$ gives rise to a demand for a total of at most
  \[
    \sum_{x\in |X'|} 4|\delta_x| \le \sum_{x\in |X'|} 4\epsilon r = 4|X'|\epsilon r\le 4c^7\epsilon r
  \]
  elements from each half.
  \todo[inline]{Explain that we use an independent set of blocks and how we (easily) get it.}
  \todo[inline]{Explain that every block we don't use just uses the straight path $a_1,\ldots,a_r$ across the top.}
  \todo[inline]{Explain that, for each of the three types of connector blocks, that type of block is used the same number of times in the first half and in the second half, so these connectors cancel each other out.}
\end{proof}

\section{Vertex Colouring}
\label{vertex_colouring}

\todo[inline]{Come up with a similar argument to show that anagram-free vertex colouring of $S_n$ with a constant number of colours is not possible.}

\todo[inline]{See if we could even do the graph $2\times n$ grid that Wilson conjectures can't be anagram-free coloured with a constant number of colours.}

\section{Proof of \cref{near_anagram_fourier}}
\label{near_anagram_section}

\todo[inline]{This proof is taken from a draft of an older paper that was proving a lower bound for anagram-free vertex colouring.  Eventually, we found a simpler argument, so we never used this proof.  Right now, it proves the existence of a $2$-balanced substring but the same technique should work to give an $\epsilon$-balanced substring.  I also think this lemma (and probably a better quantitative version) has a proof using Fourier approximation, but I don't know enough about Fourier approximation.}


\begin{proof}[Proof of \cref{near_anagram_fourier}]
  Call a string a \emph{$c$-string} if it is over an alphabet of size $c$
  and call a string \emph{good} if it contains no balanced substring.
  For each $c\in\N$, let $h_c$ denote the minimum integer for which
  there is no good $c$-string of length $2^{h_c}$.  Thus, our goal is
  to show that $h_c$ is finite for each $c\in\N$.
  Suppose this is not true so that there exists some minimum value
  $c$ for which $h_c$ is infinite.  Choosing the minimum such value of
  $c$ ensures that $h_{c-1}$ is finite and that any good (sub)string of
  length at least $r:=2^{h_{c-1}}$ uses an alphabet of size at least $c$.

  Let $s$ be a good string over the alphabet $\Sigma=\{1,\ldots,c\}$ and having
  length $r2^{h}$, for some value $h$ to specified shortly.   Consider
  the complete binary tree $T$ of height $h$ whose leaves, in order,
  are the length-1 substrings of $s$ and for which each internal node is
  the substring obtained by concatenating the node's left and right child.
  See \cref{binary_tree}.

  \begin{figure}
    \begin{center}
       \includegraphics[width=\textwidth]{figs/binary-tree-1}
    \end{center}
    \caption{Building a binary tree $T$ over the string $s$.}
    \label{binary_tree}
  \end{figure}

  For each node $v$ of $T$, let $h(v)$ denote the height of $v$'s subtree
  and $s(v)=2^{h(v)}$ denote the length of the string $v$. For each
  $i\in\Sigma$, let $w_i(v):=n_i(v)/s(v)$.  Note that $0\le w_i(v)\le
  1/2$ and that $\sum_{i\in\Sigma} w_i(v)=1$.  Furthermore, if $v$
  has two children $x$ and $y$, then $w_i(v) = (w_i(x)+w_i(y))/2$.
  The assumption that $s$ has no balanced substring implies $v$ is
  $i$-unbalanced, for some $i{t}\in\Sigma$.  Assign each internal node
  $v$ of $T$ the \emph{label} $\ell(v):=\min\{i\in\Sigma: \mbox{$v$
  is $i$-unbalanced}\}$.

  \begin{figure}
    \begin{center}
       \includegraphics[width=\textwidth]{figs/binary-tree-3}
    \end{center}
    \caption{The tree $T$ with the vector $(w_1(v),\ldots,w_5(v))$ for each
     internal node $v$.  The unbalanced index that defines $\ell(v)$ is highlited for each node.}
    \label{binary_tree_2}
  \end{figure}

  For each $i\in\Sigma$, let $S_i=\{v\in V(T): \ell(v)=i\}$ and observe that
  \[
      \sum_{v\in V(T)}s(v)=\sum_{i\in\Sigma} \sum_{v\in S_i} s(v) = (h+\log_2 r)r2^{h}
  \]
  and therefore, there exists some $i^*\in\Sigma$ such that $\sum_{v\in
  S_{i^*}}s(v)\ge (h+\log_2 r)r2^h/c$.  Let $X=S_{i^*}$ and $w=w_{i^*}$.
  From this point on the pro{t}of makes no further reference to the original
  string $s$.  It is helpful to think of $T$ as having being ordered
  so that, for each internal node $v$ with left and right children $x$
  and $y$, respectively, $w(x)\ge w(y)$.  From this point on we use
  the shorthands (for any $R\subseteq V(T)$) $s(R):=\sum_{v\in R}s(v)$
  and $w(R):=\sum_{v\in R}s(v)w(v)/s(R)$.

  Summarizing, we have a complete binary tree $T$ of height $h+\log_2 r$ and
  a subset $X\subseteq V(T)$ with the following properties:
  \begin{enumerate}
    \item For each $v\in V(T)$, $w(v) \le 1/2$.
    \item For each $v\in V(T)$ with $s(v) \ge r$, $w(v)\ge 1/r$.
    \item For each internal node $v\in V(T)$ with children $x$ and $y$,
       $w(v) = (w(x)+w(y))/2$.
    \item $w(X) \ge (h+\log_2 r)r2^{h}/c$.
     \item For each internal node $v\in V(T)\cap X$ with children $x$ and $y$,
       $w(x) > 2w(y)$.\todo{Replace with $w(x)>w(y)+\epsilon/c$}
  \end{enumerate}
  Now, for each $i\in\{1,\ldots,h\}$, let $X_i\subset X$ denote the
  set of nodes $v\in X$ for which the path from the root of $T$ to $v$
  contains exactly $i$ nodes in $X$ (including $v$).  Observe that
  \[  r2^h \ge s(X_1) \ge s(X_2) \ge \cdots\ge s(X_{h+\log_2 r}) \enspace . \]

  We will show that, there exists a constant $t$ such that,
  for each $i\in\{1,\ldots,h-t\}$,
  \begin{equation}
     s(X_{i+t}) \le (1-(1/2)^{t+1}) s(X_i) \enspace . \label{t}
  \end{equation}
  In this way,
  \begin{align*}
     (h+\log_2 r)r2^{h}/c
        \le s(X) & = \sum_{i=1}^{h+\log_2 r} s(X_i) \\
           &\le (\log_2 r)r2^{h}+\sum_{i=1}^{h} s(X_i) \\
           &\le (\log_2 r)r2^{h}+\sum_{i=1}^{h} s(X_{\floor{i/t}+1}) \\
           &\le (\log_2 r)r2^{h}+t\sum_{i=0}^{\floor{h/t}} s(X_{it+1}) \\
           &\le (\log_2 r)r2^{h}+t\sum_{i=0}^{\infty} (1-(1/2)^{t+1})^i s(X_1) \\
           &\le (\log_2 r)r2^{h}+tr2^{h}\sum_{i=0}^{\infty} (1-(1/2)^{t+1})^i  \\
           & = (\log_2 r+t2^{t+1})r2^{h}
  \end{align*}
  which is a contradiction for sufficiently large $h$; in particular, for
  \[
        h \ge (c-1)\log_2 r+ ct2^{t+1} \enspace .
  \]

  It remains to establish \cref{t}, which we do now.  For each node
  $v\in X$, let $R(v)$ denote the unique child of $v$ such that $w(R(v))
  < 2w(v)/3$, i.e., the right child of $v$. (The existence of $R(v)$ follows from Properties~3 and
  5, above).  For a subset $A\subset X$, let $R(A)=\{R(x):x\in A\}$.
  Define $A_0\subseteq X_i$ and, for each $j\ge 1$, define $A_j$
  to be the subset of $X_{i+j}$ that are descendants of some node in
  $R(A_{i-1})$.  See \cref{bigtree}. Observe that $s(A_i) \le s(R(A_{i-1})) = s(A_{i-1})/2$,
  so
   \begin{align*}
      s(X_{i+t})
         &\le (1/2)s(A_0) + (1/2)s(A_1) + \cdots + (1/2)s(A_{t-1}) + s(A_t) \\
         &\le (1/2)s(A_0) + (1/4)s(A_0) + \cdots + (1/2)^t s(A_{0}) + s(A_t) \\
         &  = (1-(1/2)^t)s(A_0) + s(A_t) \enspace .
   \end{align*}
  So all that remains to establish \eqref{t} is to prove that
  $s(A_t)\le (1/2)^{t+1}s(A_0)$.

  \begin{figure}
    \begin{center}
       \includegraphics[width=\textwidth]{figs/bigtree}
    \end{center}
    \caption{The partitioning of $X$ into $X_1,X_2,\ldots,X_h$. Shaded
    nodes are in $X$ and all nodes in $X_i$ are shaded with the same
    colour.   Starting with $A_0=X_1$, the elements of $A_0,\ldots,A_h$
    are highlighted.  The elements of $R(A_0),\ldots,R(A_h)$ are also highlighted.}
    \label{bigtree}
  \end{figure}

  Now, the key inequality is{t}
  \begin{equation}
      w(A_i) \le w(R(A_{i-1}))\cdot\frac{s(R(A_{i-1}))}{s(A_i)}
  \end{equation}
  which implies
  \begin{equation}
       w(A_i) \le (2/3)w(A_{i-1})\cdot\frac{s(A_{i-1})}{2s(A_i)}
             = (1/3)w(A_{i-1})\cdot\frac{s(A_{i-1})}{s(A_i)}
             \label{strings}
  \end{equation}

  Beginning at $A_0$ and repeatedly applying \cref{strings}, we obtain:
  \[
      w(A_t) \le (1/3)^t w(A_0)\cdot\frac{s(A_0)}{s(A_t)}
             \le (1/2)(1/3)^t \cdot\frac{s(A_0)}{s(A_t)} \enspace .
  \]
  On the other hand, $w(A_t)\ge 1/r$, so
  \[
      1/r \le (1/2)(1/3)^t\cdot\frac{s(A_0)}{s(A_t)} \enspace .
  \]
  and rearranging terms yields
  \[
     s(A_t) \le (1/2)(1/3)^t r s(A_0) \le (1/2)^{t+1}s(A_0)
  \]
  for $t = \ceil{\log_{3/2} r}$.
\end{proof}



\end{document}
